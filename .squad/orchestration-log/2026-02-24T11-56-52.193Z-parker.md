# Parker — Aspire Proxy Configuration Session

**Date:** 2026-02-24T11-56-52.193Z  
**Agent:** Parker (Frontend Dev)  
**Mode:** Background  

## Summary

Configured vite.config.ts to read Aspire service discovery environment variables for API proxy.

## Work Done

1. **Updated vite.config.ts:**
   - Added logic to read `services__api__https__0` (HTTPS, primary) or `services__api__http__0` (HTTP, fallback)
   - Configured Vite proxy to forward `/api` requests to the discovered API URL
   - Added `host: true` to Vite server config for Aspire port forwarding (binds to all interfaces)
   - Proxy only activates when env vars are set (i.e., running under Aspire)
2. **Discovered hardcoded localhost URLs:**
   - `frontend/src/services/simulationApi.ts` uses `VITE_API_URL ?? 'http://localhost:5030'`
   - `frontend/src/hooks/useSignalR.ts` uses `VITE_API_URL ?? 'http://localhost:5000'` (note: different port!)
   - These need to be updated to use relative paths (`/api`, `/hubs/simulation`) to leverage the proxy
3. **Committed and pushed** — Commit `11a3ced`

## Decisions Made

- **Configure Vite proxy with Aspire service discovery:** Use env var pattern `services__api__https__0` (prefer) or `services__api__http__0`
- **Graceful degradation:** Proxy disables when running standalone (env vars not set)
- **Host binding for port forwarding:** `host: true` enables Aspire to forward traffic from other machines

## Outcomes

- vite.config.ts reads correct API URL at runtime via Aspire service discovery
- No hardcoded localhost URLs in Vite config
- Proxy automatically disables when running standalone (backward compatible)

## Dependencies/Handoffs

- **Follow-up required:** Update `simulationApi.ts` and `useSignalR.ts` to use relative paths (`/api`, `/hubs/simulation`)
  - Without this, frontend code still hardcodes old localhost URLs and won't use the proxy
  - Reported in parker-aspire-proxy.md
